# Модель автоматизации процесса **CI/CD**

Я сделал эту модель в рамках моего плана развития. А именно пунктов, касающихся настройки процесса **CI/CD** в рамках подхода "Инфраструктура как код" и телеметрии. Для это адаптировал недавно разработанный мной калькулятор для налогов.

На что направлено (кратко):

* существенное упрощение процесса создания новых сервисов и развертывания для них окружений,
* создание изолированных стейжингов для тестирования фич,
* создания эффективной системы телеметрии для всех стейжингов;

Что предлагаю:

* использовать сборщик (например [Fake](https://fake.build/))вместо шагов Тимсити, внутри которых спрятаны маленькие CMD(BASH) скриптики и так далее. Это делает процесс декларативным и прозрачным. Не настраивать вручную шаги Тимсити заново для каждого сервиса. Вместо этого скрипт на высокоуровневом языке со статической типизацией и т.д. В системе контроля версий! Пример конфигурации в файле `build.fsx`,
* опционально: использовать селф-хостед CI/CD - сервер [Drone CI](https://drone.io/). Это даёт возможность запускать интеграционные тесты без дополнительных `docker-compose.yml` скриптов. И многое другое. К примеру очень просто делать плагины. Пример конфигурации в файле `.drone.yml`,
* (не окончено) для деплоя использовать `Kubernetes` с отдельными пространствами под каждый стейжинг (у `Drone CI` есть под это удобный плагин),
* (не окончено) для телеметрии использовать систему [Восток](https://2018.codefest.ru/lecture/1328/). Все логи, метрики и трассировки для всех стейжингов при этом в одном месте. Рассылка логов по всяким Эластиксёрчам и Графитам при этом ложится на инфраструктуру. Писать в каждом сервисе лог-мессадж-хендлер не нужно. Если честно, при внимательном изучении, мне эта именно эта реализация не очень понравилась. Об этом лучше устно.

**DroneCI** сервер: http://62.109.19.116/dsemenov87org/TaxCalculator

Кибана (пока не готово): http://62.109.19.116:6305

Графана (пока не готово): http://62.109.19.116:6303
